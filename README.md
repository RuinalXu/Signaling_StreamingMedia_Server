# 基于GB28181的信令流媒体服务器

最终实现目的：按照GB28181手册，从零开发并完成上下级信令服务器和媒体服务器，二者都是**服务端**；

---

## 开发环境：
- Ubuntu Server 22.4
- CMake项目构建 + vcpkg管理部分第三方库 + tcpdump（抓包）
- wireshark（分析Linux所抓包信息）

## 所用到的第三方库
vcpkg精选注册表端口：
1. jsoncpp：处理json文件的库；
2. timyxml2：处理XML文档的库；
3. glog：Google风格的日志库;
4. gflags：命令行参数/标志（flags）解析库；
5. libevent：高性能、跨平台的事件驱动网络库；

非精选注册表端口：
1. pjproject: https://github.com/pjsip/pjproject
    - pjsip：
2. jrtplib：
3. jthread：

# 项目的架构

整个服务端项目分为上下级开发，上级服务（CentralService）和下级服务（EdgeService）；CentralService中实现信令管理、上级流媒体服务，EdgeService中实实现下级信令服务、下级流媒体服务。

## 核心概念与技术
1. GB28181：中国联网监控系统的标准协议，其定义了监控设备之间的通信规范（包括设备注册，设备控制，实时流媒体传输等内容）；
2. SIP：用于建立、修改和终止多媒体会话的通信协议，例如视频通话；并且是GB28181实际运用的一个基础协议；
3. RTP/RTCP：GB28181协议规定的用来传输实时音视频数据的协议；
    - 规定了RTP协议可以负载PS流和h.264流数据；
    - RTP负责实时传输，RTCP则是提供了数据传输的控制和反馈机制；
    - 这两个协议综合起来是保证数据传输的一个可靠性；
4. 结合socket编程和多路IO复用：可以有效地管理和处理多个客户端的链接，提供服务器的一个并发性能，实现高效的网络通信和并发处理；
5. 任务调度与线程池：使用线程池来管理线程的创建与销毁，并将上下级的网络请求事件分配给线程池，并使用信号量与互斥锁的机制进行同步或异步处理，尽可能地提高并发能力和性能；
6. TCP/IP协议栈
    - 抓包处理TCP异常；
7. RTP/PS/h.264数据包，也是三个协议

为了提高读写事务的效率

RTP/TRSP/RTMP

后续集成GB35114

